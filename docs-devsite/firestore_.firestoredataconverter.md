Project: /docs/reference/js/_project.yaml
Book: /docs/reference/_book.yaml
page_type: reference

{% comment %}
DO NOT EDIT THIS FILE!
This is generated by the JS SDK team, and any local changes will be
overwritten. Changes should be made in the source code at
https://github.com/firebase/firebase-js-sdk
{% endcomment %}

# FirestoreDataConverter interface
Converter used by `withConverter()` to transform user objects of type `AppType` into Firestore data.

Using the converter allows you to specify generic type arguments when storing and retrieving objects from Firestore.

<b>Signature:</b>

```typescript
export declare interface FirestoreDataConverter<AppType = DocumentData, DbType extends DocumentData = AppType extends DocumentData ? AppType : DocumentData> 
```

## Methods

|  Method | Description |
|  --- | --- |
|  [fromFirestore(snapshot, options)](./firestore_.firestoredataconverter.md#firestoredataconverterfromfirestore) | Called by the Firestore SDK to convert Firestore data into an object of type <code>AppType</code>. You can access your data by calling: <code>snapshot.data(options)</code>. |
|  [toFirestore(modelObject)](./firestore_.firestoredataconverter.md#firestoredataconvertertofirestore) | Called by the Firestore SDK to convert a custom model object of type <code>AppType</code> into a plain JavaScript object, <code>DbType</code> (suitable for writing directly to the Firestore database). To use <code>set()</code> with <code>merge</code> and mergeFields<code>, </code>toFirestore()<code> must be defined with </code>PartialWithFieldValue<T>\`<!-- -->.<!-- -->The <code>WithFieldValue&lt;T&gt;</code> type extends <code>T</code> to also allow FieldValues such as [deleteField()](./firestore_.md#deletefield) to be used as property values. |
|  [toFirestore(modelObject, options)](./firestore_.firestoredataconverter.md#firestoredataconvertertofirestore) | Called by the Firestore SDK to convert a custom model object of type <code>AppType</code> into a plain JavaScript object, <code>DbType</code> (suitable for writing directly to the Firestore database). Used with [setDoc()](./firestore_.md#setdoc)<!-- -->,  and  with <code>merge:true</code> or <code>mergeFields</code>.<!-- -->The <code>PartialWithFieldValue&lt;T&gt;</code> type extends <code>Partial&lt;T&gt;</code> to allow FieldValues such as [arrayUnion()](./firestore_.md#arrayunion) to be used as property values. It also supports nested <code>Partial</code> by allowing nested fields to be omitted. |

## FirestoreDataConverter.fromFirestore()

Called by the Firestore SDK to convert Firestore data into an object of type `AppType`<!-- -->. You can access your data by calling: `snapshot.data(options)`<!-- -->.

<b>Signature:</b>

```typescript
fromFirestore(snapshot: QueryDocumentSnapshot<DbType, DbType>, options?: SnapshotOptions): AppType;
```

### Parameters

|  Parameter | Type | Description |
|  --- | --- | --- |
|  snapshot | [QueryDocumentSnapshot](./firestore_.querydocumentsnapshot.md#querydocumentsnapshot_class)<!-- -->&lt;DbType, DbType&gt; | A <code>QueryDocumentSnapshot</code> containing your data and metadata. |
|  options | [SnapshotOptions](./firestore_.snapshotoptions.md#snapshotoptions_interface) | The <code>SnapshotOptions</code> from the initial call to <code>data()</code>. |

<b>Returns:</b>

AppType

## FirestoreDataConverter.toFirestore()

Called by the Firestore SDK to convert a custom model object of type `AppType` into a plain JavaScript object, `DbType` (suitable for writing directly to the Firestore database). To use `set()` with `merge` and mergeFields`, `<!-- -->toFirestore()` must be defined with `<!-- -->PartialWithFieldValue<T>\`<!-- -->.

The `WithFieldValue<T>` type extends `T` to also allow FieldValues such as [deleteField()](./firestore_.md#deletefield) to be used as property values.

<b>Signature:</b>

```typescript
toFirestore(modelObject: WithFieldValue<AppType>): WithFieldValue<DbType>;
```

### Parameters

|  Parameter | Type | Description |
|  --- | --- | --- |
|  modelObject | [WithFieldValue](./firestore_.md#withfieldvalue)<!-- -->&lt;AppType&gt; |  |

<b>Returns:</b>

[WithFieldValue](./firestore_.md#withfieldvalue)<!-- -->&lt;DbType&gt;

## FirestoreDataConverter.toFirestore()

Called by the Firestore SDK to convert a custom model object of type `AppType` into a plain JavaScript object, `DbType` (suitable for writing directly to the Firestore database). Used with [setDoc()](./firestore_.md#setdoc)<!-- -->,  and  with `merge:true` or `mergeFields`<!-- -->.

The `PartialWithFieldValue<T>` type extends `Partial<T>` to allow FieldValues such as [arrayUnion()](./firestore_.md#arrayunion) to be used as property values. It also supports nested `Partial` by allowing nested fields to be omitted.

<b>Signature:</b>

```typescript
toFirestore(modelObject: PartialWithFieldValue<AppType>, options: SetOptions): PartialWithFieldValue<DbType>;
```

### Parameters

|  Parameter | Type | Description |
|  --- | --- | --- |
|  modelObject | [PartialWithFieldValue](./firestore_.md#partialwithfieldvalue)<!-- -->&lt;AppType&gt; |  |
|  options | [SetOptions](./firestore_.md#setoptions) |  |

<b>Returns:</b>

[PartialWithFieldValue](./firestore_.md#partialwithfieldvalue)<!-- -->&lt;DbType&gt;

### Example


```typescript
class Post {
  constructor(readonly title: string, readonly author: string) {}

  toString(): string {
    return this.title + ', by ' + this.author;
  }
}

const postConverter: FirestoreDataConverter<Post, DocumentData> = {
  toFirestore(post: WithFieldValue<Post>): DocumentData {
    return {title: post.title, author: post.author};
  },
  fromFirestore(
    snapshot: QueryDocumentSnapshot,
    options: SnapshotOptions
  ): Post {
    const data = snapshot.data(options)!;
    return new Post(data.title, data.author);
  }
};

const postSnap = await firebase.firestore()
  .collection('posts')
  .withConverter(postConverter)
  .doc().get();
const post = postSnap.data();
if (post !== undefined) {
  post.title; // string
  post.toString(); // Should be defined
  post.someNonExistentProperty; // TS error
}

```

